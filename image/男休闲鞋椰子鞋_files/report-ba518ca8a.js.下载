!function(){"use strict";function i(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},n=function(o){if(o.BJ_REPORT)return o.BJ_REPORT;var r=[],e={},c={id:0,uin:0,url:"",offline_url:"",offline_auto_url:"",ext:null,level:4,ignore:[],random:1,delay:1e3,submit:null,repeat:5,offlineLog:!1,offlineLogExp:5,offlineLogAuto:!1},u={db:null,ready:function(t){var e=this;if(!window.indexedDB||!c.offlineLog)return c.offlineLog=!1,t();if(this.db)setTimeout(function(){t(null,e)},0);else{var i=window.indexedDB.open("badjs",1);if(!i)return c.offlineLog=!1,t();i.onerror=function(i){return t(i),!(c.offlineLog=!1)},i.onsuccess=function(i){e.db=i.target.result,setTimeout(function(){t(null,e)},500)},i.onupgradeneeded=function(i){var t=i.target.result;t.objectStoreNames.contains("logs")||t.createObjectStore("logs",{autoIncrement:!0})}}},insertToDB:function(i){this.getStore().add(i)},addLog:function(i){this.db&&this.insertToDB(i)},addLogs:function(i){if(this.db)for(var t=0;t<i.length;t++)this.addLog(i[t])},getLogs:function(e,n){var i,a;this.db&&(i=this.getStore().openCursor(),a=[],i.onsuccess=function(i){var t=i.target.result;t?(t.value.time>=e.start&&t.value.time<=e.end&&t.value.id==e.id&&t.value.uin==e.uin&&a.push(t.value),t.continue()):n(null,a)},i.onerror=function(i){return n(i),!0})},clearDB:function(i){var e,n;this.db&&(e=this.getStore(),i?(n=Date.now()-24*(i||2)*3600*1e3,e.openCursor().onsuccess=function(i){var t=i.target.result;t&&(t.value.time<n||!t.value.time)&&(e.delete(t.primaryKey),t.continue())}):e.clear())},getStore:function(){return this.db.transaction("logs","readwrite").objectStore("logs")}},m={isOBJByType:function(i,t){return Object.prototype.toString.call(i)==="[object "+(t||"Object")+"]"},isOBJ:function(i){return"object"===(void 0===i?"undefined":t(i))&&!!i},isEmpty:function(i){return null===i||!m.isOBJByType(i,"Number")&&!i},extend:function(i,t){for(var e in t)i[e]=t[e];return i},processError:function(t){try{if(t.stack){var i=t.stack.match("https?://[^\n]+"),e=(e=(i=i?i[0]:"").match(":(\\d+):(\\d+)"))||[0,0,0];return{msg:m.processStackMsg(t),rowNum:e[1],colNum:e[2],target:i.replace(e[0],""),_orgMsg:t.toString()}}return t.name&&t.message&&t.description?{msg:JSON.stringify(t)}:t}catch(i){return t}},processStackMsg:function(i){var t=i.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,9).join("@").replace(/\?[^:]+/gi,""),e=i.toString();return t.indexOf(e)<0&&(t=e+"@"+t),t},isRepeat:function(i){if(!m.isOBJ(i))return!0;var t=i.msg;return(e[t]=(parseInt(e[t],10)||0)+1)>c.repeat}},l=o.onerror;o.onerror=function(i,t,e,n,a){var s=i;a&&a.stack&&(s=m.processStackMsg(a)),m.isOBJByType(s,"Event")&&(s+=s.type?"--"+s.type+"--"+(s.target?s.target.tagName+"::"+s.target.src:""):""),f.push({msg:s,target:t,rowNum:e,colNum:n,_orgMsg:i}),d(),l&&l.apply(o,arguments)};function p(){var i;clearTimeout(g),b.length&&(i=c._reportUrl+b.join("&")+"&count="+b.length+"&_t="+ +new Date,c.submit?c.submit(i):(new Image).src=i,g=0,b=[])}var v=[],b=[],g=0,d=function(i){if(c._reportUrl){for(var t,e=Math.random()>=c.random;r.length;){var n=!1,a=r.shift();if(a.msg=(a.msg+""||"").substr(0,500),!m.isRepeat(a)){var s=function(i,t){var e=[],n=[],a=[];if(m.isOBJ(i))for(var s in i.level=i.level||c.level,i){var o=i[s];if(!m.isEmpty(o)){if(m.isOBJ(o))try{o=JSON.stringify(o)}catch(i){o="[BJ_REPORT detect value stringify error] "+i.toString()}a.push(s+":"+o),e.push(s+"="+encodeURIComponent(o)),n.push(s+"["+t+"]="+encodeURIComponent(o))}}return[n.join("&"),a.join(","),e.join("&")]}(a,b.length);if(m.isOBJByType(c.ignore,"Array"))for(var o=0,l=c.ignore.length;o<l;o++){var d=c.ignore[o];if(m.isOBJByType(d,"RegExp")&&d.test(s[1])||m.isOBJByType(d,"Function")&&d(a,s[1])){n=!0;break}}n||(c.offlineLog&&(c.id,c.uin,t=a,t=m.extend({id:c.id,uin:c.uin,time:+new Date},t),u.db?u.addLog(t):(u.db||v.length||u.ready(function(i,t){t&&v.length&&(t.addLogs(v),v=[])}),v.push(t))),e||20==a.level||(b.push(s[0]),c.onReport&&c.onReport(c.id,a)))}}i?p():g=g||setTimeout(p,c.delay)}},f={},f="localhost"!=window.location.host?o.BJ_REPORT={push:function(i){var t,e,n=m.isOBJ(i)?m.processError(i):{msg:i};return c.ext&&!n.ext&&(n.ext=c.ext),n.from||(n.from=location.href),n._orgMsg?(t=n._orgMsg,delete n._orgMsg,n.level=2,(e=m.extend({},n)).level=4,e.msg=t,r.push(n),r.push(e)):r.push(n),d(),f},report:function(i,t){return i&&f.push(i),t&&d(!0),f},info:function(i){return i&&(m.isOBJ(i)?i.level=2:i={msg:i,level:2},f.push(i)),f},debug:function(i){return i&&(m.isOBJ(i)?i.level=1:i={msg:i,level:1},f.push(i)),f},reportOfflineLog:function(){window.indexedDB?u.ready(function(i,t){var a,s;t&&(a=new Date-24*c.offlineLogExp*3600*1e3,s=+new Date,t.getLogs({start:a,end:s,id:c.id,uin:c.uin},function(i,e){var n=document.createElement("iframe");n.name="badjs_offline_"+ +new Date,n.frameborder=0,n.height=0,n.width=0,n.src="javascript:false;",n.onload=function(){var i=document.createElement("form");i.style.display="none",i.target=n.name,i.method="POST",i.action=c.offline_url||c.url.replace(/badjs$/,"offlineLog"),i.enctype.method="multipart/form-data";var t=document.createElement("input");t.style.display="none",t.type="hidden",t.name="offline_log",t.value=JSON.stringify({logs:e,userAgent:navigator.userAgent,startDate:a,endDate:s,id:c.id,uin:c.uin}),n.contentDocument.body.appendChild(i),i.appendChild(t),i.submit(),setTimeout(function(){document.body.removeChild(n)},1e4),n.onload=null},document.body.appendChild(n)}))}):n.info("unsupport offlineLog")},offlineLog:function(i){return i&&(m.isOBJ(i)?i.level=20:i={msg:i,level:20},f.push(i)),f},init:function(i){if(m.isOBJ(i))for(var t in i)c[t]=i[t];var e=parseInt(c.id,10);return e&&(/qq\.com$/gi.test(location.hostname)&&(c.url||(c.url="//badjs2.qq.com/badjs"),c.uin||(c.uin=parseInt((document.cookie.match(/\buin=\D+(\d+)/)||[])[1],10))),c._reportUrl=(c.url||"/badjs")+"?id="+e+"&uin="+c.uin+"&"),r.length&&d(),u._initing||(u._initing=!0,u.ready(function(i,t){t&&setTimeout(function(){t.clearDB(c.offlineLogExp),setTimeout(function(){var i;c.offlineLogAuto&&((i=document.createElement("script")).src=c.offline_auto_url||c.url.replace(/badjs$/,"offlineAuto")+"?id="+c.id+"&uin="+c.uin,window._badjsOfflineAuto=function(i){i&&n.reportOfflineLog()},document.head.appendChild(i))},5e3)},1e3)})),f},__onerror__:o.onerror}:o.BJ_REPORT={push:function(){return f},report:function(){return f},info:function(){return f},debug:function(){return f},reportOfflineLog:function(){},offlineLog:function(){return f},init:function(){return f},__onerror__:o.onerror};return"undefined"!=typeof console&&console.error&&setTimeout(function(){(location.hash||"").match(/([#&])BJ_ERROR=([^&$]+)/)},0),f}(window);"undefined"!=typeof module&&(module.exports=n);!function(){for(var i=["mb2345browser","ucbrowser"],t=window.navigator.userAgent.toLocaleLowerCase(),e={id:1,combo:0,url:"//badjs.qidian.qq.com/badjs",level:2},n=0;n<i.length;n++)if(-1!==t.indexOf(i[n])){$.extend(e,{ignore:[/Script error/i]});break}BJ_REPORT.init(e)}();var h=function(i,t){var e,n,i=i||window.location.href;if(t){e=new RegExp("[?&]"+t+"=([^&#]*)","i");try{n=e.exec(i)[1]}catch(i){n=null}}else n=i.substring(i.indexOf("?")+1);return n};var s,o,_=(o="QD_PM",{receive:function(i,e){var t,n,a;n="message",a=function(i){var t=function(i){var t,e=/uc_msg|oppo_night|weibo|msfapi|axure/i,n=Object.prototype.toString;try{if(t="[object String]"==n.call(i)&&JSON.parse(i).ldpUrl,e.test(t))return i}catch(i){}return!(!i||"[object String]"!==n.call(i)||e.test(i))&&i}(i.data);if(t){-1==t.indexOf(o)&&BJ_REPORT&&BJ_REPORT.report("PM NO Flag "+t);try{s=JSON.parse(t)}catch(i){}"function"==typeof e&&e(s)}},(t=i).addEventListener?t.addEventListener(n,a,!1):t.attachEvent("on"+n,a)},send:function(i,t){var e=s?$.extend(s,i):i,n=t||"CHAT";e.hasOwnProperty(o)&&e[o]==n||(e[o]=n),e="string"!=typeof e?JSON.stringify(e):e,window.parent.postMessage(e,"*")}}),c=document;function e(){var e={};return{type:"memory",getItem:function(i){return i in e&&e[i]},setItem:function(i,t){return e[i]=t,!0},removeItem:function(i){return i in e&&delete e[i]},clear:function(){return e={},!0}}}var a,l=window.parent!=window;window;function y(){this.create=function(i,t){return this.ioLink=io.connect(i,t),this},this.close=function(){this.ioLink&&this.ioLink.disconnect()},this.emitMsg=function(i,t,e,n){return this.ioLink&&this.ioLink.compress(!1).emit(i,t),e&&e.call(n),this},this.receiveMsg=function(i,t,e,n,a){e=e||this;return a?this.ioLink.once(i,function(i){n&&$.extend(i,n),t&&t.call(e,i)}):this.ioLink.on(i,function(i){n&&$.extend(i,n),t&&t.call(e,i)}),this},this.getLiveStatus=function(){return this.ioLink&&this.ioLink.connected}}var d={SOCKET_CHAT:"https://"+__domain.chat,STATUS_MANAGER:"https://webpage.qidian.qq.com/qidian/chatClient/release/status/js/report-ba518ca8a.js",QQ_FACE:"https://"+__domain.source+".com/qidian/chatClient/release/comp/img/qq/",GET_SIGT:"https://"+__domain.admin+"/webim/webImLogin/getSigT",GET_TENCENT_SCHEME:"https://"+__domain.admin+"/tp/wpaCall/getWebProtocol",UPLOAD_IMG:"https://"+__domain.admin+"/webim/pic/upload",DOWNLOAD:"https://"+__domain.admin+"/webim/media/download?name=dance.amr&",UPLOAD_FILE:"https://"+__domain.admin+"/webim/media/upload",DOWNLOAD_FILE:"https://"+__domain.admin+"/webim/file/download",ROUTE_CHANGE_LOADING:{QQ:"https://"+__domain.admin+"/template/blue/wpa/link.html"},GET_GRAPHIC_MSG:"https://"+__domain.admin+"/webim/innerPage/getGraphicMsg",GET_OFFLINE_MSG:"https://"+__domain.admin+"/webim/offlineMessage/getMessages",COMP_SOURCE_URL:"https://"+__domain.source+".com/qidian/chatClient/release/comp/",GET_MENU_URL:"https://"+__domain.admin+"/webim/innerPage/getNav",GET_FEEDBACK_RET:"https://"+__domain.admin+"/webim/innerPage/feedBack",ACT_RPT:"https://"+__domain.admin+"/ar/ActCap/ActRpt",GET_SERVER_TIME:"https://"+__domain.admin+"/webim/commonRequest/checkTime",GET_ADD_FRIEND_SCHEME:"https://"+__domain.admin+"/tp/wpaCall/GetAddFriendProtocol",COMMON_REQ_RPT:"https://"+__domain.admin+"/webim/commonRequest/actRpt",GET_RELATED_MESSAGE:"https://"+__domain.zhiwen+"/robot/complete-words",ROBOT_SATISFACTION_REPORT:"https://"+__domain.admin+"/cl/robotSatisfaction/robotReport",GET_WX_MP_OPENID:"https://"+__domain.admin+"/webim/wx/getMpOpenId",CHECK_WX_VISITORID:"https://"+__domain.admin+"/webim/wx/checkVisitorId",CHECK_THIRD_VISITORID:"https://"+__domain.admin+"/webim/nonAnonymous/getVisitorId",GET_WX_MP_JSSDK_SIGNATURE:"https://"+__domain.admin+"/webim/wx/getSignature",GET_WX_MP_JSSDK_SOURCE:"https://res.wx.qq.com/open/js/jweixin-1.4.0.js",GET_SKIN_CORP_INFO:"https://"+__domain.admin+"/webim/innerPage/getPCIMInfo",GET_SKIN_BUBBLE_INFO:"https://"+__domain.admin+"/webim/innerPage/getCommonConfig",GET_MINI_SDK:"https://res.wx.qq.com/open/js/jweixin-1.3.2.js",GET_RECEPTION_DETAIL:"https://"+__domain.admin+"/webim/innerPage/getEmployeeInfo",GET_LEAVE_MSG_CONFIG:"https://"+__domain.admin+"/reception/leaveMessage/customerMessageConfig",SEND_LEAVE_MSG_FORM:"https://"+__domain.admin+"/reception/leaveMessage/customerMessageCreate",TEXT_TRANSLATE:"https://"+__domain.admin+"/ts/translate/textTranslate",TRANSLATE_LANG_CHANGE:"https://"+__domain.admin+"/webim/commonRequest/setTranslateLang",GET_ROAMING_LIST:"https://"+__domain.admin+"/webim/roam/getMessage",GET_MSG_INFO_DATA:"https://"+__domain.admin+"/webim/innerPage/getXmlMsgData",GET_BUSINESS_CARD_DATA:"https://"+__domain.admin+"/webim/innerPage/fetchBusinessCard",GET_AUTO_CHANGE:"https://"+__domain.admin+"/zhiku/webim/transfer",GET_NAV_INFO:"https://"+__domain.admin+"/zhiku/webim/getNavInfo",GET_HOT_QA:"https://"+__domain.admin+"/zhiku/navigation/hotqa",GET_MSG_DISPLAYED:"https://"+__domain.admin+"/webim/innerPage/getMsgDisplayed",GET_VOICE_FILE:"https://"+__domain.admin+"/webim/ptt/download?kfuin=",GET_VOICE_INPUT_UPLOAD:"https://"+__domain.admin+"/webim/media/upload",GET_VOICE_INPUT_TRANSFER:"https://oazhiwen.qidian.qq.com/olapi/asr/transfer?inner_appid=10002",FORM_DISTRIBUTION_MARKET_URL:__domain.marketForm+"/static/webim-form-collector_0.0.1/index.js"},r=(i(a={tencentCert:'<div class="tencent-certification">\n                <a href="<%=o.website%>" target="_blank">\n                    <img class="tencent-certification__logo" src="<%=o.logo%>" />\n                </a>\n                <span class="tencent-certification__name"><%=o.name%></span>\n            </div>',tencentCertContent:'<img class="tencent-certification__logo" src="<%=o.logo%>" /><span class="tencent-certification__name"><%=o.name%></span>',time:'<div class="msg-time"><%==timeStamp%></div>',sys:'<div class="msg-sys" data-guid="<%=seq%>">\n                    <span class="text"><%==msg%></span>\n                </div>',name_custom_bubble:'<div class="msg-b2c" data-guid="<%=seq%>"><p class="avatar"><img src="<%=avatar%>"/></p><div class="content"><p class="name"><%=name%></p><div class="bubble"></div></div></div>',name:'<div class="msg-b2c" data-guid="<%=seq%>"><p class="avatar"><img src="<%=avatar%>"/></p><div class="content"><p class="name"><%=name%></p><div class="bubble"></div></div></div>',video:'<div class="media" data-type="<%=img_type%>"><i class="icon-media<%=img_type%>"></i><p class="text"><%==data%></p></div>',file:'<div class="bubble type_file <%==bigClass%>" ><i></i><div class="progress"></div><img class="icon_type" src="<%==iconsrc%>"/><div class="info"><p class="text"><span class="filename"><%==filename%></span></p><p class="status"><span class="filesize"><%==fileSize%></span><span class="status-text"><%==statusText%></span></p></div></div>',b2c:'<div class="msg-b2c" data-guid="<%=seq%>"><p class="avatar"><img src="<%=avatar%>"/></p><div class="content"><p class="name"><span class="name-text ellipsis"><%=name%></span></p><div class="bubble"><p class="text"><%==data%></p></div></div></div>',b2cTyping:'<div class="msg-b2c msg-typing" data-guid="<%=seq%>"><p class="avatar"><img src="<%=avatar%>"/></p><div class="content"><p class="name"><span class="name-text ellipsis"><%=name%></span></p><div class="bubble"><p class="text typing"><span class="typing_placehold">正在输入...</span></p></div></div></div>',b2cMerge:'<div class="msg-b2c" data-guid="<%=seq%>"><p class="avatar"><img src="<%=avatar%>"/></p><div class="content"><p class="name"><span class="name-text ellipsis"><%=name%></span></p><div class="bubble"><p class="text merge-msg">answerContent</p></div></div></div>',b2cImage:'<div class="msg-b2c msg-image" data-guid="<%=seq%>"><p class="avatar"><img src="<%=avatar%>"/></p><div class="content"><p class="name"><span class="name-text ellipsis"><%=name%></span></p><div class="bubble"><p class="image"><img src="<%=data%>"/><i class="loading loading-s"></i></p></div></div></div>',b2cWrap:'<div class="msg-b2c <%=o.msgType%> <%=o.msgName%>" data-guid="<%=o.seq%>">\n                        <p class="avatar"><img src="<%=o.face || o.avatar%>"/></p>\n                        <div class="content">\n                            <p class="name"><span class="name-text ellipsis"><%=o.name%></span></p>\n                            <div class="bubble">msgContent\n                              <% if(o.vote) { %>\n                              <div class="b2c-content-tails" data-id="<%=o.vote.id%>">\n                                  <% if (o.vote.active) { %>\n                                    <span class="b2c-content-tails-icon active b2c-content-tails-icon-<%= (o.vote.active.index == 0 ? \'up\' : \'down\')%>"><span class="b2c-content-tails-hand"></span></span>\n                                  <% } else {%>\n                                    <% for (var i = 0; i < (o.vote.button && o.vote.button.length); i++) {%>\n                                    <span data-key="<%=o.vote.button[i].key%>" data-index="<%=i%>" class="b2c-content-tails-icon b2c-content-tails-icon-<%= (i === 0 ? \'up\' : \'down\')%>"><span class="b2c-content-tails-hand"></span></span>\n                                    <% } %>\n                                  <% } %>\n                              </div>\n                              <% } %>\n                            </div>\n                        </div>\n                    </div>',b2cBtn:'<div class="msg-b2c <%=o.msgType%> <%=o.msgName%>" data-guid="<%=o.seq%>">\n                        <p class="avatar"><img src="<%=o.face || o.avatar%>"/></p>\n                        <div class="content">\n                            <p class="name"><span class="name-text ellipsis"><%=o.name%></span></p>\n                            <div class="bubble">msgContent\n                              <% if(o.vote) { %>\n                              <div class="b2c-content-tails" data-id="<%=o.vote.id%>">\n                                  <% if (o.vote.active) { %>\n                                    <span class="b2c-content-tails-icon active b2c-content-tails-icon-<%= (o.vote.active.index == 0 ? \'up\' : \'down\')%>"><span class="b2c-content-tails-hand"></span></span>\n                                  <% } else {%>\n                                    <% for (var i = 0; i < (o.vote.button && o.vote.button.length); i++) {%>\n                                    <span data-key="<%=o.vote.button[i].key%>" data-index="<%=i%>" class="b2c-content-tails-icon b2c-content-tails-icon-<%= (i === 0 ? \'up\' : \'down\')%>"><span class="b2c-content-tails-hand"></span></span>\n                                    <% } %>\n                                  <% } %>\n                              </div>\n                              <% } %>\n                            </div>\n                            <div class="bubble-btn">bubbleBtn</div>\n                        </div>\n                    </div>',voice:'<div class="msg-voice <%=expired%>"><div class="bubble" style="width: <%=width%>px;"><div class="red-read" style="display: <%=display%>;"></div><i></i><span class="duration"><%=duration%>"</span><div class="tip"><div class="txt-icon"></div>转文字</div></div></div>'},"b2cBtn",'<div class="msg-b2c <%=o.msgType%> <%=o.msgName%>" data-guid="<%=o.seq%>">\n                        <p class="avatar"><img src="<%=o.face || o.avatar%>"/></p>\n                        <div class="content">\n                            <p class="name"><span class="name-text ellipsis"><%=o.name%></span></p>\n                            <div style="overflow: hidden"> \n                                <div class="bubble">msgContent\n                                  <% if(o.vote) { %>\n                                  <div class="b2c-content-tails" data-id="<%=o.vote.id%>">\n                                      <% if (o.vote.active) { %>\n                                        <span class="b2c-content-tails-icon active b2c-content-tails-icon-<%= (o.vote.active.index == 0 ? \'up\' : \'down\')%>"><span class="b2c-content-tails-hand"></span></span>\n                                      <% } else {%>\n                                        <% for (var i = 0; i < (o.vote.button && o.vote.button.length); i++) {%>\n                                        <span data-key="<%=o.vote.button[i].key%>" data-index="<%=i%>" class="b2c-content-tails-icon b2c-content-tails-icon-<%= (i === 0 ? \'up\' : \'down\')%>"><span class="b2c-content-tails-hand"></span></span>\n                                        <% } %>\n                                      <% } %>\n                                  </div>\n                                  <% } %>\n                                </div>\n                            </div>\n                            <div class="bubble-btn">bubbleBtn</div>\n                        </div>\n                    </div>'),i(a,"c2bVideo",'<div class="msg-c2b" data-guid="<%=seq%>"><div class="bubble" data-style="senderBubble"></div></div>'),i(a,"c2b",'<div class="msg-c2b" data-guid="<%=seq%>"><div class="bubble" data-style="senderBubble"><i></i><p class="text"><%==data%></p><svg class="bubble-arrow" data-style="bubbleArrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.64 16.95"><path d="M15.63,5.05C11.34,9.36,4.61,10,1.59,10H.86C.34,10,0,10,0,10s0,0,0,0H0V22H3.69C16.56,13.53,15.63,5.05,15.63,5.05Z" transform="translate(0 -5.05)"/></svg></div></div>'),i(a,"c2bImage",'<div class="msg-c2b msg-image" data-guid="<%=seq%>"><div class="bubble" data-style="senderBubble"><i></i><p class="image"><img src="<%=data%>"/></p><svg class="bubble-arrow" data-style="bubbleArrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.64 16.95"><path d="M15.63,5.05C11.34,9.36,4.61,10,1.59,10H.86C.34,10,0,10,0,10s0,0,0,0H0V22H3.69C16.56,13.53,15.63,5.05,15.63,5.05Z" transform="translate(0 -5.05)"/></svg></div></div>'),i(a,"c2bFile",'<div class="msg-c2b msg-file" data-guid="<%=seq%>"><div class="bubble"></div></div>'),i(a,"c2bVoice",'<div class="msg-c2b msg-voice <%=expired%>" data-guid="<%=seq%>"><div class="bubble" data-style="senderBubble" style="width: <%=width%>px;"><i></i><span class="duration"><%=duration%>"</span><div class="tip"><div class="txt-icon"></div>转文字</div><svg class="bubble-arrow" data-style="bubbleArrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.64 16.95"><path d="M15.63,5.05C11.34,9.36,4.61,10,1.59,10H.86C.34,10,0,10,0,10s0,0,0,0H0V22H3.69C16.56,13.53,15.63,5.05,15.63,5.05Z" transform="translate(0 -5.05)"/></svg></div></div>'),i(a,"c2bVoiceRecording",'<div class="msg-c2b msg-voice msg-voice--recording"><div class="bubble" data-style="senderBubble"><i></i><span class="duration"></span><div class="tip"><div class="txt-icon"></div>转文字</div><svg class="bubble-arrow" data-style="bubbleArrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.64 16.95"><path d="M15.63,5.05C11.34,9.36,4.61,10,1.59,10H.86C.34,10,0,10,0,10s0,0,0,0H0V22H3.69C16.56,13.53,15.63,5.05,15.63,5.05Z" transform="translate(0 -5.05)"/></svg></div></div>'),i(a,"c2bWrap",'<div class="msg-c2b <%=o.msgType%> <%=o.msgName%>" data-guid="<%=o.seq%>">\n                    <div class="bubble" data-style="senderBubble">msgContent<svg class="bubble-arrow" data-style="bubbleArrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.64 16.95"><path d="M15.63,5.05C11.34,9.36,4.61,10,1.59,10H.86C.34,10,0,10,0,10s0,0,0,0H0V22H3.69C16.56,13.53,15.63,5.05,15.63,5.05Z" transform="translate(0 -5.05)"/></svg></div>\n                </div>'),i(a,"callqq",'<div class="msg-offline">\n                        <div class="content">\n                            <div class="kf-detail">\n                                <p class="avatar"><img src="<%=avatar%>"/></p>\n                                <dl class="detail">\n                                    <dt><%=name%></dt>\n                                    <dd><%=corpName%><span class="resign"><%=resign%></span></dd>\n                                </dl>\n                            </div>\n                            <a href="javascript:;" class="btn-act" data-style="button" reqpos="1">$$$common_start_qq_chat_text$$$</a>\n                        </div>\n                    </div>'),i(a,"callqqCorpUin",'<div class="msg-offline">\n                            <div class="content">\n                                <div class="kf-detail">\n                                    <p class="avatar"><img src="<%=corpAvatar%>"/></p>\n                                    <dl class="detail">\n                                        <dt><%=corpName%></dt>\n                                    </dl>\n                                </div>\n                                <a href="javascript:;" class="btn-act" data-style="button" reqpos="1">$$$common_start_qq_chat_text$$$</a>\n                            </div>\n                        </div>'),i(a,"msgLoad",{getMsg:'<div class="load-status"><a href="javascript:;" class="btn-load-msg"><%==text%></a></div>',loading:'<div class="load-status"><p class="status-loading"><i class="loading loading-s"></i><span class="text"><%==text%></span></p></div>',overTip:'<p class="status-tip"><span class="text"><%==text%></span></p>',numTip:'<a href="javascript:;" class="btn-offlinemsg-gotop"><%==text%>条新消息<i class="icon-arrow-up"></i></a>'}),i(a,"menuMsgNormal",'<div class="mod-menu <% if(o.config.welcome == 1) { %>wel<% } %><% if(o.config.menu == 1) { %>nav<% } %><% if(o.config.button == 1) { %>btn<% } %>" data-guid="<%=o.guid%>" data-oldver="<% if(o.version >= o.currentVersion) {%>0<%} else {%>1<%}%>" data-version="<%=o.version%>">\n                    <div class="menu-wrap"><% if(o.version >= o.currentVersion) { %>\n                        <% if(o.config.welcome == 1 && (o.navVersion == 1 || !o.navVersion)) { %>\n                            <div class="menu-wel">\n                                <div class="tit">\n                                    <dl>\n                                        <dt><img src="<%=o.eLogo%>" width="25" height="25"/></dt>\n                                        <dd><%=o.welcome.tit%></dd>\n                                    </dl>\n                                </div>\n                                <% if(o.config.description == 1 ) { %>\n                                    <p class="text"><%=o.description%></p>\n                                 <% } %>\n                            </div>\n                        <% } %><% if(o.navVersion === \'2\') { %>\n                            <div class="menu-wel menu-wel--v2">\n                                <div class="tit">\n                                    <dl>\n                                        <dt><img src="<%=o.eLogo%>" width="25" height="25"/></dt>\n                                        <dd><%=o.welcome.tit%></dd>\n                                    </dl>\n                                </div>\n                                <% if(o.config.description == 1 ) { %>\n                                    <p class="text"><%=o.description%></p>\n                                 <% } %>\n                            </div>\n                            <% if(o.config.menu === 1) { %>\n                                <div class="menu-nav menu-nav--v2">\n                                    <% for(var i = 0, l = o.menu.list.length;i<l;i++) {\n                                          var replyType = typeof o.menu.list[i].manualType != \'undefined\' ? o.menu.list[i].manualType : o.menu.list[i].replyType;\n                                          var currentMenu = o.menu.list[i];\n                                          var currentMenuId = currentMenu.menuId;\n                                          var currentNavId = currentMenu.navId;\n                                          var parentId = currentMenu.parentId;\n                                          var parentName = currentMenu.parentName;\n                                          var robotNav = o.menu.list[i].robotNav ? JSON.stringify(o.menu.list[i].robotNav):"{}"\n                                    %>\n                                    <div class="nav-item">\n                                        <div class="nav-hd">\n                                            <a href="javascript:;" data-parentid="<%=parentId%>" data-parentname="<%= parentName %>" data-menuid="<%=currentMenuId%>" data-navid="<%=currentNavId%>" data-action="<%= o.menu.list[i].action%>" data-robotnav="<%= robotNav%>" data-origin-replytype="<%=o.menu.list[i].replyType %>" data-origin-replytext="<%= o.menu.list[i].replyText %>" data-origin-materialid="<%= o.menu.list[i].materialId %>" data-replytype="<%= replyType %>" data-replydata="<%=o.menu.list[i].serviceKfext || o.menu.list[i].robotId || o.menu.list[i].groupId || o.menu.list[i].replyText || o.menu.list[i].imgurl || o.menu.list[i].url || o.menu.list[i].materialId%>"><span class="text"><%= o.menu.list[i].name%></span><% if(o.menu.list[i].action == 4 && o.menu.list[i].sublist) { %><i class="icon-arrow-down"><% if(o.isMobile) { %><svg><use xlink:href="#back"/></svg><% } %></i><% } %></a></div><%if(o.menu.list[i].action == 4 && o.menu.list[i].sublist) {%>\n                                        <div class="nav-bd">\n                                            <ul><% for(var k = 0, len = o.menu.list[i].sublist.length;k<len;k++) {\n                                                      var subReplyType = typeof o.menu.list[i].sublist[k].manualType != \'undefined\' ? o.menu.list[i].sublist[k].manualType : o.menu.list[i].sublist[k].replyType;\n                                                      var subItem = currentMenu.sublist[k];\n                                                      var subRobotNav = subItem.robotNav ? JSON.stringify(subItem.robotNav):"{}"\n                                                %>\n                                                <li><a href="javascript:;" data-parentid="<%= subItem.parentId %>" data-parentname="<%= subItem.parentName %>" data-menuid="<%=currentMenu.sublist[k].menuId%>" data-navid="<%= currentMenu.sublist[k].navId %>" data-action="<%= o.menu.list[i].sublist[k].action%>" data-robotnav="<%= subRobotNav%>" data-origin-replytype="<%= o.menu.list[i].sublist[k].replyType %>" data-origin-replytext="<%= o.menu.list[i].sublist[k].replyText %>" data-origin-materialid="<%= o.menu.list[i].sublist[k].materialId %>" data-replytype="<%= subReplyType %>" data-replydata="<%= o.menu.list[i].sublist[k].serviceKfext || o.menu.list[i].sublist[k].robotId || o.menu.list[i].sublist[k].groupId || o.menu.list[i].sublist[k].replyText || o.menu.list[i].sublist[k].imgurl || o.menu.list[i].sublist[k].url || o.menu.list[i].sublist[k].materialId%>"><%= o.menu.list[i].sublist[k].name%></a></li><% } %>\n                                            </ul>\n                                        </div><% } %>\n                                    </div><% } %>\n                                </div>\n                            <% } %>\n                        <% } %><% if(o.config.menu == 1 && (o.navVersion == 1 || !o.navVersion)) { %><div class="menu-nav">\n                            <p class="tit"><%=o.menu.tit%></p>\n                            <% for(var i = 0, l = o.menu.list.length;i<l;i++) {%><div class="nav-item">\n                                <div class="nav-hd">\n                                    <a href="javascript:;" data-action="<%= o.menu.list[i].action%>" data-origin-replytype="<%=o.menu.list[i].replyType %>" data-origin-replytext="<%= o.menu.list[i].replyText %>" data-origin-materialid="<%= o.menu.list[i].materialId %>" data-replytype="<%= o.menu.list[i].manualType || o.menu.list[i].replyType %>" data-replydata="<%=o.menu.list[i].serviceKfext || o.menu.list[i].groupId || o.menu.list[i].replyText || o.menu.list[i].imgurl || o.menu.list[i].url || o.menu.list[i].materialId%>"><span class="text"><%= o.menu.list[i].name%></span> <% if(o.menu.list[i].action == 4 && o.menu.list[i].sublist) { %><i class="icon-arrow-down"><% if(o.isMobile) { %><svg><use xlink:href="#back"/></svg><% } %></i><% } %></a>\n                                </div><% if(o.menu.list[i].action == 4 && o.menu.list[i].sublist) { %>\n                                <div class="nav-bd">\n                                    <ul><% for(var k = 0, len = o.menu.list[i].sublist.length;k<len;k++) {\n                                        var oldSubItem = o.menu.list[i].sublist[k];\n                                        var oldSubRobotNav = oldSubItem.robotNav ? JSON.stringify(oldSubItem.robotNav):"{}"\n                                        %>\n                                        <li><a href="javascript:;" data-action="<%= o.menu.list[i].sublist[k].action%>" data-origin-replytype="<%= o.menu.list[i].sublist[k].replyType %>" data-origin-replytext="<%= o.menu.list[i].sublist[k].replyText %>" data-origin-materialid="<%= o.menu.list[i].sublist[k].materialId %>" data-robotnav="<%= oldSubRobotNav%>" data-replytype="<%= o.menu.list[i].sublist[k].manualType || o.menu.list[i].sublist[k].replyType %>" data-replydata="<%= o.menu.list[i].sublist[k].serviceKfext || o.menu.list[i].sublist[k].robotId || o.menu.list[i].sublist[k].groupId || o.menu.list[i].sublist[k].replyText || o.menu.list[i].sublist[k].imgurl || o.menu.list[i].sublist[k].url || o.menu.list[i].sublist[k].materialId%>"><%= o.menu.list[i].sublist[k].name%></a></li><% } %>\n                                    </ul>\n                                </div><% } %>\n                            </div><% } %>\n                        </div><% } %><% if(o.config.button == 1) { %><div class="menu-action">\n                            <ul><% for(var i = 0, l = o.button.length;i<l;i++) {\n                                var oldButtonRobotNav = o.button[i].robotNav ? JSON.stringify(o.button[i].robotNav):"{}"\n                                %>\n                                <li style="width:<%= o.buttonWidth %>%"><a href="javascript:;" data-parentid="<%= parentId%>" data-parentname="<%= parentName%>" data-menuid="<%= o.button[i].menuId%>" data-navid="<%= o.button[i].navId%>" data-action="<%= o.button[i].action%>" data-robotnav="<%= oldButtonRobotNav%>" data-origin-replytype="<%= o.button[i].replyType %>" data-origin-replytext="<%= o.button[i].replyText %>" data-origin-materialid="<%= o.button[i].materialId %>" data-replytype="<%= o.button[i].manualType || o.button[i].replyType %>" data-replydata="<%= o.button[i].serviceKfext || o.button[i].robotId || o.button[i].groupId || o.button[i].replyText || o.button[i].imgurl || o.button[i].url || o.button[i].materialId%>"><%= o.button[i].name%></a></li><% } %>\n                            </ul>\n                        </div><% } %><% } else { %>\n                        <div class="menu-disabled">\n                            <dl>\n                                <dt></dt>\n                                <dd>$$$chat_menu_msg_history_expired_text$$$</dd>\n                            </dl>\n                        </div><% } %>\n                    </div>\n                  </div>'),i(a,"menuMsgExpired",'<div class="menu-disabled">\n                            <dl>\n                                <dt></dt>\n                                <dd>$$$chat_menu_msg_history_expired_text$$$</dd>\n                            </dl>\n                        </div>'),i(a,"feedback",'<div class="mod-fb" data-fbkey=<%= o.fbKey %>>\n                            <div class="fb-wrap">\n                                <p class="tit">$$$chat_feedback_title_text$$$</p>\n                                <div class="fb-level">\n                                    <% for(var i = 0;i < o.levelDesc.length; i++) {%><a href="javascript:;" data-desc="<%= o.levelDesc[i] %>"><i class="fd-icon fd-icon-<%= i %>"></i><span><%= o.levelDesc[i] %></span></a><% } %>\n                                </div><% if(o.hasDesc) {%>\n                                <div class="fb-desc">\n                                    <div class="post-text"><p class="text"></p></div>\n                                    <div class="post-area">\n                                        <textarea maxlength="<%= o.availLetterSum %>" placeholder="$$$chat_feedback_postarea_placeholder$$$"></textarea>\n                                        <span class="num"><%= o.availLetterSum %></span>\n                                    </div>\n                                    <a href="javascript:;" class="btn-submit">$$$chat_feedback_submit_text$$$</a>\n                                </div><% } %>\n                                <button class="fb-loading">$$$chat_feedback_submitting_text$$$</button>\n                            </div>\n                        </div>'),i(a,"blackTip",'<div class="mod-black-tip"><p class="text"><%= o.text %></p></div>'),i(a,"grayResult",'<div class="mod-gray-result"><i class="icon-fail gray-icon"></i><p class="text"><%= o.msg %></p></div>'),i(a,"voiceTipAll",'<div class="mod-voice-tip-h"><div class="voice-talk"></div><div class="voice-tip"><span><%= o.tip %></span></div><i class="voice-icon <%=o.icon%>"></i></div>'),i(a,"voiceTip",'<div class="mod-voice-tip"><i class="voice-icon <%=o.icon%>"></i><div class="voice-tip"><span><%= o.tip %></span></div></div>'),i(a,"translateTip",'<div class="mod-translate-tip"><i class="translate-icon <%=o.icon%>"></i><div class="translate-tip"><span><%= o.tip %></span></div></div>'),i(a,"receptionInfo",'<div class="mod-desc">\n                            <p class="logo"><img src="<%=o.avatar%>" width="64" height="64" alt="<%=o.name%>" title="<%=o.name%>"/></p>\n                            <p class="name" title="<%=o.name%>"><%=o.name%></p>\n                            <p class="company" title="<%=o.company%>"><%=o.company%></p>\n                            <p class="position" title="<%=o.position%>"><%=o.position%></p>\n                        </div>\n                        <div class="mod-connect">\n                            <ul>\n                                <% if(o.signature) { %><li title="<%=o.signature%>"><i class="icon-signature"></i><%=o.signature%></li><% } %>\n                                <% if(o.phone) { %><li><i class="icon-phone"></i><a href="tel:<%=o.phone%>" title="<%=o.phone%>"><%=o.phone%></a></li><% } %>\n                                <% if(o.fixedPhone) { %><li><i class="icon-tel"></i><a href="tel:<%=o.fixedPhone%>" title="<%=o.fixedPhone%>"><%=o.fixedPhone%></a></li><% } %>\n                                <% if(o.email) { %><li><i class="icon-email"></i><a href="mailto:<%=o.email%>" title="<%=o.email%>"><%=o.email%></a></li><% } %>\n                                <% if(o.companySites) { %><li><i class="icon-link"></i><a href="<%=o.companySites%>"  title="<%=o.companySites%>" target="_blank"><%=o.companySites%></a></li><% } %>\n                                <% if(o.companyAddress) { %><li title="<%=o.companyAddress%>"><i class="icon-address"></i><%=o.companyAddress%></li><% } %>\n                            </ul>\n                        </div>'),i(a,"privacyTips_b2c_base",'<div id="imTopNotic" class="im-tips im-tips--b2c-base">\n                                    <div class="im-tips__content"><%=o.tips%></div>\n                                    <div class="im-tips__close-btn"></div>\n                               </div>'),i(a,"b2cCommodity",'<div class="msg-b2c"><p class="avatar"><img src="<%= o.avatar %>"/></p><div class="content"><div class="bubble-list"></div></div></div>'),i(a,"c2bCommodity",'<%\n        var item = JSON.stringify(o)\n        %>\n        <div class="msg-c2b msg-info">\n            <div class="cardList">\n                <div class="cardList-body" data-info=\'<%= item %>\'>\n                    <% if(o.logo) {%>\n                        <div class="left"><img src="<%= o.logo %>" /></div>\n                    <% } %>\n                    <div class="right">\n                        <div class="m1"><%= o.tit %></div>\n                        <div class="m2">\n                            <% if(o.des) {%>\n                                <%= o.des %>\n                            <% } %>\n                        </div>\n                        <div class="bottom">\n                            <div class="bottom-left">\n                                <div class="m3">￥<span><%= o.mon %></span></div>\n                                <div class="m4">x<span><%= o.count %></span></div>\n                            </div>\n                            <div class="bottom-right m4">\n                                <span><%= o.much %></span>件已售\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <% if(o.selected) {%>\n                    <div class="cardList-bottom">重新选择</div>\n                <% } %>\n            </div>\n        </div>'),i(a,"commodityInfo",{bubbleListHead:'<li class="bubbleList-body-head">\n                                <div class="left">\n                                <img src="<%= o.logo %>" alt="" class="logo">\n                                <div class="tit"><%= o.name %></div>\n                                </div>\n                                <div class="right">\n                                    <div class="status"><%= o.status %></div>\n                                </div>\n                        </li>',bubbleListBody:'<%\n                var item = JSON.stringify(o)\n                %>\n                    <li class="bubbleList-body-body" data-info=\'<%= item %>\'>\n                        <% if(o.logo) {%>\n                            <div class="left"><img src="<%= o.logo %>" /></div>\n                        <% } %>\n                        <div class="right">\n                            <div class="m1"><%= o.tit %></div>\n                            <div class="m2"><%= o.des %></div>\n                            <div class="bottom">\n                                <div class="bottom-left">\n                                    <div class="m3">￥<span><%= o.mon %></span></div>\n                                    <div class="m4">x<span><%= o.count %></span></div>\n                                </div>\n                                <div class="bottom-right m4">\n                                    <span><%= o.much %></span>件已售\n                                </div>\n                            </div>\n                        </div>\n                    </li>',drawerListHead:'<div class="drawer-item drawerList-body-head">\n                                <div class="left">\n                                <img src="<%= o.logo %>" alt="" class="logo">\n                                <div class="tit"><%= o.name %></div>\n                                </div>\n                                <div class="right">\n                                    <div class="status"><%= o.status %></div>\n                                </div>\n                            </div>',drawerListBody:'<%\n            var item = JSON.stringify(o)\n            %>\n                <div class="drawer-item drawer-link drawerList-body-body" data-info=\'<%= item %>\'>\n                    <% if(o.logo) {%>\n                        <div class="left"><img src="<%= o.logo %>" /></div>\n                    <% } %>\n                    <div class="right">\n                        <div class="m1"><%= o.tit %></div>\n                        <div class="m2"><%= o.des %></div>\n                        <div class="bottom">\n                            <div class="bottom-left">\n                                <div class="m3">￥<span><%= o.mon %></span></div>\n                                <div class="m4">x<span><%= o.count %></span></div>\n                            </div>\n                            <div class="bottom-right m4"><span><%= o.much %></span>件已售</div>\n                        </div>\n                    </div>\n                </div>',cardListBody:'<%\n            var item = JSON.stringify(o)\n            %>\n                <li class="cardList-body" data-info=\'<%= item %>\'>\n                    <div class="top"><img src="<%= o.logo %>" alt="" class="logo"></div>\n                        <div class="bottom">\n                        <div class="bottom-top"><%= o.tit %></div>\n                    </div>\n                </li>',acrossList:'<div class="msg-b2c acrossList" data-guid="<%= o.seq %>">\n                <div class="ac-top">\n                    <p class="avatar">\n                        <img src="<%= o.avatar %>"/>\n                    </p>\n                    <div class="content">\n                        <p class="name">\n                            <span class="name-text ellipsis"><%= o.name %></span>\n                        </p>\n                        <div class="bubble">\n                            <p class="text"><%= o.data.tit %></p>\n                        </div>\n                    </div>\n                </div>\n                <div class="ac-bottom">\n                <% if(!o.isMobile) {%>\n                    <div class="left-btn icon-arrow-right disabled"></div>\n                <% } %>\n                <ul class="card-list"></ul>\n                <% if(!o.isMobile) {%>\n                    <div class="right-btn icon-arrow-right"></div></div>\n                <% } %>\n            </div>'}),(new Date).getTime(),window.location.href),f={win:window,onceRegCb:[],onceRegFailedCb:[],isCommonRobot:"",roleValue:h(r,"roleValue"),roleData:h(r,"roleData"),plat:h(r,"plat")||"",receptionist:{},wpaDetail:{},getSignTData:{},kfChangeTip:0,isGetSignT:0,isRegOK:0,pageTurning:!1,openName:2,isMobile:0,isChangeKF:0,inRegProcess:0,isRealSendMsg:1,isTranslate:1,isInIframe:l,defaultAvatar:d.COMP_SOURCE_URL+"img/default-avatar.png",imageLoadFail:d.COMP_SOURCE_URL+"img/image-load-fail.png",reSendC2bMsg:null,ioLinkStatus:null,regSuccessCallBack:null,imStatus:"open",pageStatus:"show",clickName:"click",chatSocket:new y,c2bDBsaveData:[],c2bSeqGroup:[],authConfig:{auth:0},menuDetail:{active:0,currentVersion:"",eLogo:"",eName:"",defaultConfig:{active:0}},seqs:{key:"",data:[]},getSigTData:{},originRoleValue:null,clientPingTimer:null,serverClientTimeDiff:0,htReportOpts:{flag1:21873,flag2:1},registerType:"default",routePermit:{isCorpUin:0,isNeedQQ:1},lang:"zh-cn",translate:{translateSwitch:!1,translateLang:"zh",translateAuto:!0},wxConfig:{enableVoice:!1,appid:"",openid:""},externalType:1,isShowQidianSign:1,isShowBusinessCard:1,isShowVoiceCall:0,isShowAudo:0,isSendImage:1,isShowFace:1,isShowManualClose:0,isShowVoice:0,isShowFile:0,CORSCookie:!0,thirdAppConfig:{enable:!1,type:"",appType:0,appId:"",openId:"",userInfo:null},guidanceInfo:{},visitorName:"",fileUploadAborts:{},sysSeqAndSortSeqMap:{},isBanByCompany:0,qdMiniStaticUrl:"https://qidian-wx-trtc-6gqhclos07127f45-1306025886.tcloudbaseapp.com/jump-mp.html",robotDelay:{switch:!0,time:8,typing:!0},robotDelayOptions:{robotDelayMsg:"",lastTypingSeq:"",timer:null,robotDelayFunc:function(i,t,e){f.robotDelayOptions.timer=setTimeout(function(){i.replaceRobotTyping(t,{isGoBot:!0}),f.robotDelayOptions.timer=null},e)}},manualMsgOptions:{timer:null,endDelayTimer:null,isTyping:!1},commoditySeq:"",personalName:"",robotType:null},u=f.win.navigator.userAgent.toLocaleLowerCase();f.userAgent=u;var m,p,v,b,g,w,T,S,I,k,E,x,N,O,M,R,C,A=function(i){var b=e();try{"localStorage"in i&&i.localStorage&&(i.localStorage.setItem("test","test"),i.localStorage.removeItem("test"),b=i.localStorage)}catch(i){BJ_REPORT&&BJ_REPORT.report(JSON.stringify(i))}function g(i){return b.removeItem(i)}return{type:b.type,get:function(i){return b.getItem(i)},set:function(m,p){var v=!1;try{b.setItem(m,p),v=!0}catch(i){v=!1,22===i.code&&function(){var i=f.seqs,t=i.key,e=i.data,n=t.substring(0,t.length-4)+"index";do{var a=Math.round(e.length/2);e.splice(0,a).forEach(function(i){return g(n+i)});try{b.setItem(m,p),v=!0,b.setItem(t,JSON.stringify(e));for(var s=f.receptionist,o=s.kfUin,l=s.visitorId,d="kf"+o,r=JSON.parse(b.getItem(d))||[],c=0;c<r.length;c++){var u=r[c];if(u.visitorId===l){u.total=e.length;break}}b.setItem(d,JSON.stringify(r))}catch(i){v=!1}}while(!v)}()}return v},remove:g,clear:function(){return b.clear()}}}(window);function L(i){var t,e="tencentSig",n=void 0===A.type||"memory"===A.type;f.thirdAppConfig.secretKey&&(e="tencentThirdSig");var a,s,o,l,d,r={active:!1,url:""};return $.extend(r,i),l=(o=r.active)?h(r.url,"visitorId"):(a=e,null!=(s=c.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(s[2]):null),/^\d+$/.test(l)||(l=""),!o&&n&&(l?A.set(e,l):(l=A.get(e),/^\d+$/.test(l)||(l=""))),(t=l)||(d=(Math.floor(10*Math.random())||1)+function(i,t){var e,n,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s=[];if(t=t||a.length,i)for(e=0;e<i;e++)s[e]=a[0|Math.random()*t];else for(s[8]=s[13]=s[18]=s[23]="-",s[14]="4",e=0;e<36;e++)s[e]||(n=0|16*Math.random(),s[e]=a[19==e?3&n|8:n]);return s.join("")}(3,10)+(new Date).getTime().toString().slice(2,13),n?A.set(e,d):function(i,t,e,n,a){a=a&&new Date(+new Date+a);var s=i+"="+escape(t)+(a?"; expires="+a.toGMTString():"")+(n?"; path="+n:"")+(e?"; domain="+e:"");s.length<4096&&(c.cookie=s)}(e,d,null,"/",31536e6),t=d),t}function D(){function i(i){var t=document.createElement("b");return t.innerHTML="\x3c!--[if IE "+i+"]><i></i><![endif]--\x3e",1===t.getElementsByTagName("i").length}function t(i,t){return""!==i?i+t.slice(0,1).toUpperCase()+t.slice(1):t}var e,n=void 0,a=null,s=i(),o=i(9),l=o?"":null,d=(e=!1,"number"==typeof window.screenX&&["webkit","moz","ms","o",""].forEach(function(i){0==e&&null!=document[t(i,"hidden")]&&(l=i,e=!0)}),e);function r(){n=!1,o?document.dispatchEvent(a):document.documentElement.visibilitychange=1}function c(){n=!0,o?document.dispatchEvent(a):document.documentElement.visibilitychange=0}s&&!d&&(document.addEventListener?(window.addEventListener("focus",r,!0),window.addEventListener("blur",c,!0)):(document.attachEvent("onfocusin",r),document.attachEvent("onfocusout",c)),void 0===document.createEvent||a?document.documentElement.visibilitychange=0:(a=document.createEvent("HTMLEvents")).initEvent("visibilitychange",!0,!0));function u(){return d?document[t(l,"hidden")]:void 0!==n?n:void 0}function m(){return d?document[t(l,"visibilityState")]:void 0!==n?n?"hidden":"visible":void 0}return{hidden:u(),isHidden:u,isPageVisibilitySupport:d,visibilityState:m(),visibilitychange:function(t){if("function"==typeof t){if(d||o)return document.addEventListener(l+"visibilitychange",function(i){t.call(this,i,u(),m())},!1);document.documentElement.attachEvent("onpropertychange",function(i){"visibilitychange"==event.propertyName&&t.call(this,i,u(),m())})}}}}function B(i,t){return i.test(t)}function q(i){var t=i||navigator.userAgent,e=t.split("[FBAN");if(void 0!==e[1]&&(t=e[0]),void 0!==(e=t.split("Twitter"))[1]&&(t=e[0]),this.apple={phone:B(v,t),ipod:B(b,t),tablet:!B(v,t)&&B(g,t),device:B(v,t)||B(b,t)||B(g,t)},this.amazon={phone:B(S,t),tablet:!B(S,t)&&B(I,t),device:B(S,t)||B(I,t)},this.android={phone:B(S,t)||B(w,t),tablet:!B(S,t)&&!B(w,t)&&(B(I,t)||B(T,t)),device:B(S,t)||B(I,t)||B(w,t)||B(T,t)},this.windows={phone:B(k,t),tablet:B(E,t),device:B(k,t)||B(E,t)},this.other={blackberry:B(x,t),blackberry10:B(N,t),opera:B(O,t),firefox:B(R,t),chrome:B(M,t),device:B(x,t)||B(N,t)||B(O,t)||B(R,t)||B(M,t)},this.seven_inch=B(C,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this}m=window,v=/iPhone/i,b=/iPod/i,g=/iPad/i,w=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,T=/Android/i,S=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,I=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,k=/Windows Phone/i,E=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,x=/BlackBerry/i,N=/BB10/i,O=/Opera Mini/i,M=/(CriOS|Chrome)(?=.*\bMobile\b)/i,R=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,C=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),m.isMobile=((p=new q).Class=q,p);var P={link:"https://"+(__domain||{chat:"chat.qidian.qq.com"}).chat,opts:{path:"/status",reconnectionDelay:2e3,reconnectionDelayMax:3e3,reconnectionAttempts:2,timeout:2e4,transports:["websocket"]}},G={statusNotice:{emit:"active_notice"},b2cMsgNum:{receive:"b2c_msg_num",emit:"b2c_msg_num ack"},invitation:{receive:"session_invitation",emit:"user_operate"},inviteAutoConf:{emit:"invite_auto_conf",receive:"invite_auto_conf"},msgDisplay:{receive:"msg_displayed",emit:"msg_displayed_ack"}},F=function(n){var i,t,e,a,s={},o=[],l={},d=L(),r=(i=n.location.href,t=h(i,"linkType"),e=h(i,"visitorId"),a=n.parent!=n,e&&0<e.length&&(t=1),!(!(t&&0<(""+t).length)||a)),c=D();function u(i){i&&_.send(i,"ONLINE_STATUS")}c.isPageVisibilitySupport&&c.visibilitychange(function(i,t,e){setTimeout(function(){0==t&&"visible"==e&&f()},500)});var m=new y;function p(i){switch(n.qd_qid_for_rpt=i.qid||"",i.__QIDIAN_WPA_VISITORID_FOR_RPT&&(n.__QIDIAN_WPA_VISITORID_FOR_RPT=i.__QIDIAN_WPA_VISITORID_FOR_RPT),i.act){case"SM_INIT":if(s&&s.kfuin==i.kfuin)return;(s=i).linkType=i.linkType?1:0,o.push(s),v(s);break;case"SM_REFUSE":m.emitMsg(G.invitation.emit,{action:"refuse"});break;case"SMS_SM_FORCE_CONNECT":f();break;case"SM_INVITE_RET":m.emitMsg(G.invitation.emit,{operate:void 0})}}function v(e){m.emitMsg(G.statusNotice.emit,e,function(i){var t;0==i.errcode&&(r||(t=e,m.emitMsg(G.inviteAutoConf.emit,t),m.receiveMsg(G.inviteAutoConf.receive,function(i){u({act:"SM_INVITE_CONF",kfuin:i.body.invitationConf.kfuin,inviteRule:i.body.invitationConf})})))})}function b(){for(var i=0,t=o.length;i<t;i++)v(o[i])}function g(e){d&&$.extend(P.opts,{query:"queryId="+d}),m.create(P.link,P.opts),m.ioLink.once("connect",function(){var i,t;m.receiveMsg(G.b2cMsgNum.receive,function(i){var t=i.body,e="kfuin"+t.kfuin;m.emitMsg(G.b2cMsgNum.emit),t.number=t.msgNum||0,delete t.seq,delete t.msgNum,void 0!==t.receptionName?l[e]=t.receptionName:t.receptionName=l.hasOwnProperty(e)?l[e]:null,u({act:"SM_UNREAD",kfuin:t.kfuin,data:t})}),m.receiveMsg(G.msgDisplay.receive,function(i){var t=i.body,e="kfuin"+t.kfuin;delete t.seq,void 0!==t.receptionName?l[e]=t.receptionName:t.receptionName=l.hasOwnProperty(e)?l[e]:null,t.kfuin=s.kfuin,u({act:"SM_DISPLAY",data:t,kfuin:s.kfuin})}),m.receiveMsg(G.invitation.receive,function(i){var t=i.body.kfuin;delete i.body.kfuin,u({act:"SM_MANUAL_INVITE",kfuin:t,data:i.body})}),"reconnect"==e?b():(u({act:"SM_READY"}),r&&(i=n.location.href,t=h(i,"kfuin"),u({act:"SM_INIT",visitorId:d,kfuin:t,linkType:1,isMobile:Number(isMobile)})))}),m.ioLink.once("reconnect_attempt",function(){"undefined"!=typeof WebSocket&&void 0!==WebSocket.prototype.send||(m.ioLink.io.opts.path="/polling_session",m.ioLink.io.opts.transports=["polling","websocket"])}),m.ioLink.once("reconnect",function(){b()}),m.ioLink.once("disconnect",function(i){"transport close"===i&&u({act:"DISCONNECT"})})}function f(){m.ioLink&&m.ioLink.disconnected&&g("reconnect")}return m.emitMsg=function(i,t,e,n){return this.ioLink.emit(i,t,function(){e&&e.apply(n,arguments)}),this},{start:function(){n.CURRENT_VISITORID&&(d=n.CURRENT_VISITORID),g(),_.receive(n,p)},forceConnect:f}}(window);(window.__STATUS_MANAGER=F).start()}();